<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwillbs.mapper.UserMapper">

    <!-- 로그인 -->
    <select id="login" resultType="com.itwillbs.domain.UserVO">
        SELECT 
            id,
            userid,
            userpw,
            email,
            name,
            phone,
            addr,
            profile_img AS profileImg,
            status,
            created_at AS createdAt
        FROM user
        WHERE userid = #{userid}
          AND userpw = #{userpw}
    </select>

    <!-- 회원가입 -->
    <insert id="insertUser">
        INSERT INTO user 
        (userid, userpw, email, name, phone, addr, profile_img)
        VALUES 
        (#{userid}, #{userpw}, #{email}, #{name}, #{phone}, #{addr}, #{profileImg})
    </insert>

    <!-- 회원 조회 -->
    <select id="getUser" resultType="com.itwillbs.domain.UserVO">
        SELECT 
            id,
            userid,
            userpw,
            email,
            name,
            phone,
            addr,
            profile_img AS profileImg,
            status,
            created_at AS createdAt
        FROM user
        WHERE userid = #{userid}
    </select>

    <!-- 수정 -->
    <update id="updateUser">
        UPDATE user
        SET 
            name = #{name},
            phone = #{phone},
            addr = #{addr},
            profile_img = #{profileImg}
        WHERE userid = #{userid}
    </update>

    <!-- 탈퇴(status=1) -->
    <update id="deleteUser">
        UPDATE user
        SET status = 1
        WHERE userid = #{userid}
    </update>

    <!-- 중복체크 -->
    <select id="checkUserid" resultType="int">
        SELECT COUNT(*)
        FROM user
        WHERE userid = #{userid}
    </select>

</mapper>
